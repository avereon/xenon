# This is a sample build configuration for Java (Maven).
# Check our guides at https://confluence.atlassian.com/x/zd-5Mw for more examples.
# Only use spaces to indent your .yml configuration.
# -----
# You can specify a custom docker image from Docker Hub as your build environment.
# https://hub.docker.com/r/library/maven/tags/
image: maven:3.5.0-jdk-9

# TODO: research. i wonder if we can add a script step fpr "apk add --no-cache openjfx" or maybe we just need out own image

pipelines:
  default: # replace `default` level with levels `branches.master` or any other branch to limit builds to that branch
           # limiting builds to a branch allows you to dev on another branch, commit+push often, and not chew through your build minutes
    - step:
        caches:
          - maven
        script: # Modify the commands below to build your repository.
          # - apt-get install -y openjfx
          - cp settings.xml $HOME/.m2/settings.xml
          - mvn -B clean deploy

          # you can run any command to move your artifact elsewhere
          # like to BitBucket Downloads for example

          # TODO read the link, populate BB_AUTH_STRING, enjoy a nice cold lemonade
          # https://confluence.atlassian.com/bitbucket/deploy-build-artifacts-to-bitbucket-downloads-872124574.html
          # - curl -X POST "https://${BB_AUTH_STRING}@api.bitbucket.org/2.0/repositories/${BITBUCKET_REPO_OWNER}/${BITBUCKET_REPO_SLUG}/downloads" --form files=@"`ls -tr target/*.jar | tail -n1`"
